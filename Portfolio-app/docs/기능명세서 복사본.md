아래는 **“멀티자산(국내/해외주식·채권·원자재 등) 기반 포트폴리오 관리 앱”**을 전제로 한 **상세 기능명세서(Functional Spec)** 입니다.  
(기획자 관점에서 _화면/기능/데이터/정책/예외/권한/비기능_까지 최대한 촘촘하게 작성)

---

## 0. 제품 개요

### 0.1 제품 목적

- 사용자가 여러 계좌/자산군을 통합하여 **다수의 포트폴리오를 구성**
    
- **실시간 평가액/손익/리스크**를 직관적으로 확인
    
- 포트폴리오 간 **성과 비교(백테스트, 벤치마크, 동종 포트 비교)** 및 리밸런싱 의사결정 지원
    
- 세금/환율/수수료/배당 등 현실 요소를 반영한 “투자 운영”을 돕는 개인용 PM(Portfolio Manager)
    

### 0.2 타깃 사용자

- 국내주식 위주 + 해외ETF/원자재까지 확장하는 개인 투자자
    
- 여러 전략(예: 성장/배당/모멘텀/헤지)을 **포트폴리오로 분리**해 관리하려는 사용자
    
- “내 성과가 시장 대비 어떤지” 정량 비교를 원하는 사용자
    

### 0.3 핵심 가치 제안

- **멀티 포트폴리오 + 멀티자산 통합 뷰**
    
- **실시간 평가/환산(원화 기준)**
    
- **정교한 비교(백테스트/벤치마크/기여도/리스크)**
    

---

## 1. 용어/정의

- **상품(Instrument)**: 주식/ETF/펀드/채권/원자재/현금 등 단일 종목 단위
    
- **포지션(Position)**: 특정 상품의 보유수량/평균단가/비중
    
- **거래(Transaction)**: 매수/매도/입금/출금/배당/이자/수수료/세금
    
- **포트폴리오(Portfolio)**: 포지션 집합 + 현금 + 운용규칙(리밸런싱/제약)
    
- **벤치마크(Benchmark)**: KOSPI, S&P500, MSCI World, KIS채권지수 등 비교 기준
    
- **TWR(시간가중수익률)** / **MWR(금액가중수익률, IRR)**
    

---

## 2. 범위(Scope)

### 2.1 포함(In)

- 멀티 포트폴리오 생성/편집/비교
    
- 실시간 시세 기반 평가액/손익/환산(환율 포함)
    
- 거래 입력(수동) + (선택) 증권사 연동(추후)
    
- 백테스트(전략/리밸런싱 규칙 기반) + 벤치마크 비교
    
- 리스크/성과 분석(변동성, MDD, 샤프, 베타, 상관, 기여도)
    
- 알림(리밸런싱/급락/목표비중 이탈/뉴스)
    

### 2.2 제외(Out) 1차 MVP

- 실제 주문/매매 실행(Trading)
    
- 레버리지/파생(옵션·선물) 고급 마진 계산(2차)
    
- 복잡한 세법 시뮬레이션(국가별 세율 자동 최적화는 2차)
    

---

## 3. 정보구조(IA) / 주요 메뉴

- **홈(요약 대시보드)**
    
- **포트폴리오**
    
    - 포트폴리오 목록
        
    - 포트폴리오 상세
        
    - 리밸런싱/규칙
        
- **비교/분석**
    
    - 포트폴리오 간 비교
        
    - 벤치마크 비교
        
    - 백테스트 스튜디오
        
- **거래/기록**
    
    - 거래내역
        
    - 배당/이자/수수료
        
- **자산(상품 탐색)**
    
    - 종목 검색/관심
        
    - 상품 상세(차트/지표/기초정보)
        
- **알림/인사이트**
    
- **설정**
    
    - 통화/세금/수수료/데이터 소스
        
    - 보안/백업/내보내기
        

---

## 4. 기능명세 (상세)

# 4.1 사용자/계정/보안

### 4.1.1 로그인/가입

- 지원: 이메일/소셜(Apple/Google)
    
- 필수: 약관동의(서비스/개인정보), 데이터 처리 동의(시세/환율 API)
    
- 선택: 2FA(OTP/SMS/패스키), 생체인증(앱 잠금)
    

**예외/정책**

- 계정 삭제: 보관정책(즉시 삭제 vs 7일 유예) 설정 가능
    
- 개인정보: 최소 수집(이메일/닉네임), 투자데이터는 암호화 저장
    

### 4.1.2 보안 요구사항

- 전송: TLS
    
- 저장: 민감정보(토큰/연동키) 서버 KMS + DB 암호화
    
- 앱 잠금: 5분 미사용 시 잠금 옵션
    
- 백업: 사용자 요청 시 암호화 내보내기(JSON/CSV)
    

---

# 4.2 포트폴리오 생성/관리(핵심)

### 4.2.1 포트폴리오 생성

**입력값**

- 이름(필수), 설명(선택), 기준통화(기본 KRW)
    
- 유형: (1) 실제 보유 기반 (2) 가상/전략 (3) 백테스트 전용
    
- 운용목표: 성장/배당/방어/테마/혼합(태그)
    
- 리밸런싱 규칙 템플릿 선택(선택)
    

**UX**

- 3-step wizard
    
    1. 포트폴리오 목적/통화
        
    2. 자산 추가(검색/스캔/추천)
        
    3. 목표비중/제약 설정
        

**검증**

- 목표비중 합 100% (±0.5% 허용 후 자동 정규화 옵션)
    
- 동일 상품 중복 추가 시 “합치기/분리(트랜치)” 선택
    

### 4.2.2 포트폴리오 편집

- 이름/설명/태그/표시순서
    
- 구성 종목 추가/삭제
    
- 목표비중 수정(드래그/숫자 입력/슬라이더)
    
- 자산군 분류 재정의(예: ETF를 ‘미국주식’ vs ‘섹터’)
    

### 4.2.3 포트폴리오 복제/스냅샷

- “현재 구성 복제” → 새로운 포트 생성
    
- 스냅샷 저장(날짜/메모) → 비교 시 특정 시점 구성 불러오기
    

### 4.2.4 포트폴리오 그룹/폴더

- 예: “장기”, “단기”, “연금”, “실험전략”
    
- 그룹별 합산 성과/리스크 제공
    

---

# 4.3 자산/상품 마스터(멀티자산 지원)

### 4.3.1 지원 자산군

- 국내주식(KRX), 해외주식(US 중심 + 확장), ETF/ETN
    
- 원자재: 금/은/원유 등(현물/선물지수/ETF 형태로 매핑)
    
- 채권: 국채/회사채(직접/ETF), MMF/현금성
    
- 현금: 통화별 현금 포지션(KRW/USD/JPY…)
    

### 4.3.2 상품 검색/추가

- 검색: 티커/이름/ISIN
    
- 필터: 자산군/국가/거래소/통화/운용사(ETF)
    
- 추가 방식:
    
    - “보유로 추가”(수량/평균단가 입력)
        
    - “목표비중으로 추가”(수량 없이 목표비중만)
        

### 4.3.3 상품 상세

- 기본정보: 거래소, 통화, 섹터/산업, 시가총액, ETF면 보수/추종지수
    
- 차트: 1D/1W/1M/1Y/전체, 로그/선형
    
- 이벤트: 배당/분할/권리락(가능 범위)
    
- 포트폴리오 내 영향: 비중, 손익, 기여도, 상관도
    

---

# 4.4 실시간 평가액/손익(“오늘 상태”)

### 4.4.1 평가 엔진(Real-time Valuation)

**산출**

- 포트폴리오 평가액(기준통화 환산)
    
- 평가손익(절대/%)
    
- 일간 손익(오늘 변동)
    
- 자산군별/종목별 기여도(Contribution)
    

**데이터**

- 시세: 실시간(가능하면) / 지연(무료 구간)
    
- 환율: 실시간 또는 T+0 레이트, 고정환율 옵션(설정)
    

**정책**

- 장 마감/휴장 시: 마지막 종가 기준, “시장 닫힘” 배지
    
- 해외 자산: 프리/애프터(지원 시 별도 표시)
    

### 4.4.2 평가 화면 UX(포트폴리오 상세)

- 상단: 총평가액, 오늘손익, 누적수익률
    
- 탭:
    
    1. 구성(비중 도넛 + 리스트)
        
    2. 성과(기간별 수익률)
        
    3. 리스크(MDD/변동성/샤프 등)
        
    4. 거래(최근 거래/배당)
        
    5. 인사이트(편중/리밸런싱 필요)
        

**리스트 표준 컬럼**

- 종목명/티커
    
- 현재가
    
- 보유수량
    
- 평가액/비중
    
- 손익(원/%) / 금일변동
    

---

# 4.5 거래/현금흐름/원가관리(현실 반영)

### 4.5.1 거래 입력

**유형**

- 매수/매도
    
- 입금/출금(현금 이동)
    
- 배당/이자(현금 유입)
    
- 수수료/세금(현금 유출)
    
- 환전(통화 간 이동)
    

**필드**

- 날짜/시간
    
- 상품(현금흐름은 통화 선택)
    
- 수량/단가/금액
    
- 수수료/세금(자동 계산 옵션)
    
- 메모/태그(예: “리밸런싱”, “추가매수”)
    

**원가계산 방식 옵션**

- 평균단가(기본)
    
- FIFO/LIFO(세부 구현은 2차 가능, 1차는 평균단가 권장)
    

### 4.5.2 배당/이자 처리

- 지급일/기준일, 배당금(통화), 원천징수(옵션)
    
- 재투자(DRIP) 설정:
    
    - “현금으로 보유”
        
    - “같은 ETF/종목 자동 매수로 간주(가상)”
        
- 배당 캘린더: 월별 예상/실적
    

### 4.5.3 현금 관리

- 통화별 현금 계정
    
- 포트폴리오 내 “현금 비중” 표시
    
- 목표 현금비중 설정 가능(예: 5%)
    

---

# 4.6 수익률 계산(정확한 성과 지표)

### 4.6.1 수익률 종류

- **누적수익률**(단순)
    
- **TWR**(추천 기본)
    
- **MWR/IRR**(현금흐름 반영)
    
- 기간: 1D/1W/1M/3M/6M/YTD/1Y/3Y/5Y/전체/사용자 지정
    

### 4.6.2 기준/비교

- 기준통화 KRW로 환산 성과(기본)
    
- “원자산 통화 기준 성과” 토글(예: USD 기준)
    

### 4.6.3 성과 기여도

- 종목별 수익 기여(Contribution to Return)
    
- 자산군/국가/섹터별 기여도 집계
    

---

# 4.7 포트폴리오 비교(요구사항 핵심)

### 4.7.1 비교 대상 선택

- 포트폴리오 A vs B vs C (최대 5개)
    
- 벤치마크 포함 비교(최대 3개)
    

### 4.7.2 비교 지표

- 성과: 누적/TWR/MWR, 월별 수익률 표, 캘린더 히트맵
    
- 리스크: 변동성(연율), MDD, 샤프, 소르티노, 칼마
    
- 시장민감도: 베타, 알파(선형회귀)
    
- 상관/중복: 상관행렬, 종목 중복도(%), 섹터 중복도
    
- 효율: “수익률/리스크” 산점도(효율적 프론티어는 2차)
    

### 4.7.3 UX

- 상단: 비교 기간/수익률 기준 토글(TWR/MWR)
    
- 중앙: 라인차트(누적) + 드로다운 차트(옵션)
    
- 하단: 지표 테이블 + “해석 카드”
    
    - 예: “B는 수익률은 낮지만 MDD가 절반이라 방어적”
        

---

# 4.8 백테스트 스튜디오(전략 비교)

### 4.8.1 백테스트 유형

1. **정적 비중(Static Allocation)**
    
2. **주기 리밸런싱**(월/분기/반기/연)
    
3. **밴드 리밸런싱**(목표비중 ±x% 이탈 시)
    
4. **룰 기반**(간단 규칙: 모멘텀 상위 N, 변동성 타겟 등) — 2차 확장
    

### 4.8.2 입력 파라미터

- 시작/종료 날짜
    
- 초기자본(기준통화)
    
- 리밸런싱 주기/밴드
    
- 거래비용(수수료/슬리피지 %)
    
- 배당 재투자 여부
    
- 세금 반영(간단 옵션)
    
- 데이터 빈도: 일/주/월(기본 일)
    

### 4.8.3 결과 출력

- 누적수익률 곡선(전략 vs 벤치마크)
    
- 리스크 지표(위 4.7.2 동일)
    
- 연도별 성과 테이블
    
- 리밸런싱 내역 로그(언제 무엇을 얼마나 매수/매도 했는지)
    
- “결론 요약” 카드(자동 인사이트)
    

### 4.8.4 신뢰성/제약 고지(중요)

- 데이터 공백/상장일/폐지 종목 처리 로직 명시
    
- 과최적화 경고(파라미터 튜닝 시 경고 배너)
    

---

# 4.9 리밸런싱(실행 지원)

### 4.9.1 리밸런싱 진단

- 현재비중 vs 목표비중
    
- 이탈도(%) 및 우선순위(이탈 큰 종목부터)
    
- 추천 거래안(목표 달성 최소 거래 / 현금 제약 고려)
    

### 4.9.2 제약조건

- 최소 거래금액
    
- 매수 가능 현금 한도
    
- 특정 자산군 상한(예: 해외주식 ≤ 60%)
    
- 금지 종목(ESG/개인 제한)
    

### 4.9.3 실행 모드

- “가상 실행”(시뮬레이션) → 결과 확인
    
- “거래 입력으로 반영”(실제 기록 반영)
    
- (추후) 증권사 연동 시 “주문 장바구니”로 export
    

---

# 4.10 알림/인사이트

### 4.10.1 알림 유형

- 목표비중 이탈(±x%)
    
- 평가액 급변(일간 -3%, -5% 등)
    
- 배당 지급/예정
    
- 리밸런싱 예정일
    
- 목표 수익률/손절 라인 도달(사용자 정의)
    

### 4.10.2 인사이트 카드

- 편중 경고: “상위 3종목 비중 55%”
    
- 상관 경고: “두 포트가 상관 0.92로 거의 동일”
    
- 환율 영향: “이번 달 수익의 40%가 환율 기여”
    
- 방어력 평가: “MDD가 벤치마크 대비 낮음”
    

---

# 4.11 데이터/연동/API (시세·환율·지수)

### 4.11.1 데이터 소스 요구

- 시세: 국내/해외 분리 가능 (무료/유료 플랜)
    
- 환율: 주요통화 USD/KRW, JPY/KRW, EUR/KRW 등
    
- 벤치마크 지수: KOSPI/KOSDAQ/S&P500/NASDAQ100/AGG 등 대표 ETF로 대체 가능
    

### 4.11.2 데이터 갱신 정책

- 실시간 모드: 5~15초 폴링 or 스트리밍(가능 시)
    
- 기본 모드: 1~5분 지연
    
- 백테스트: EOD(종가) 기반
    

### 4.11.3 오류 처리

- 시세 실패 시: 마지막 캐시 + “갱신 실패” 토스트 + 재시도
    
- 환율 실패 시: 최근 값 유지, “고정환율 사용” 옵션 안내
    

---

## 5. 화면 명세(대표)

### 5.1 홈(대시보드)

- 상단: 전체 자산(모든 포트 합산) / 오늘 손익 / 누적 손익
    
- 카드:
    
    - “내 포트 TOP3” (성과 높은 순)
        
    - “리밸런싱 필요” (이탈 큰 순)
        
    - “이번 달 배당” 요약
        
- 하단: 포트 목록(스와이프/핀 고정)
    

### 5.2 포트폴리오 상세

- 헤더: 평가액 + 변동 + 기간 선택
    
- 섹션:
    
    - 비중 차트(자산군/종목 토글)
        
    - 종목 테이블(정렬: 비중/손익/변동성)
        
    - 인사이트/알림 설정
        

### 5.3 비교 화면

- 선택: 포트 multi-select
    
- 차트: 누적수익률 라인
    
- 표: 핵심 지표 10개 + 툴팁 설명
    

### 5.4 백테스트 스튜디오

- 입력 폼(좌) + 결과(우) 형태(모바일이면 stepper)
    
- 결과 탭: 성과/리스크/로그/비교
    

---

## 6. 권한/역할(개인 앱 기준)

- 기본: 단일 사용자
    
- (확장) 가족/팀 공유:
    
    - Viewer(읽기)
        
    - Editor(편집/거래 입력)
        
    - Owner(삭제/공유 관리)
        

---

## 7. 비기능 요구사항(NFR)

### 7.1 성능

- 홈 로딩: 2초 이내(캐시 활용)
    
- 실시간 평가 갱신: UI 프리즈 없이(백그라운드 갱신 + 스켈레톤)
    

### 7.2 안정성/정합성

- 계산 엔진(수익률/원가) 단위테스트 필수
    
- 데이터 버전 관리(백테스트 결과 재현 가능)
    

### 7.3 접근성/UX

- 숫자 가독성: 큰 금액 단위 축약(예: 1.2억) + 원본 표시 툴팁
    
- 색맹 모드(선택)
    
- “초보 모드”: 핵심만 보이게, 지표 설명 강화
    

---

## 8. 로드맵 제안(현실적인 단계)

### MVP (1차)

- 포트 생성/편집
    
- 수동 거래 입력
    
- 실시간(또는 지연) 평가액/손익
    
- 기본 비교(누적수익률, MDD, 변동성)
    
- 간단 백테스트(정적 비중 + 주기 리밸런싱)
    

### v1.5

- 배당/이자 캘린더 + 재투자 옵션
    
- 인사이트 카드/알림 고도화
    
- 상관/중복 분석
    

### v2

- 규칙 기반 전략(모멘텀/변동성 타겟)
    
- 증권사 연동/자동 거래내역 불러오기(가능 범위)
    
- 세금/수수료 정교화(국가별)
    

---

## 9. 수용 기준(샘플)

- 사용자는 3개 이상의 포트폴리오를 만들고, 각 포트에 국내/해외/채권/원자재를 혼합해 담을 수 있어야 한다.
    
- 포트폴리오 상세에서 **실시간 평가액/오늘손익/누적손익**이 일관되게 계산되어야 한다(통화 환산 포함).
    
- 비교 화면에서 최소 2개 포트의 **동일 기간 누적수익률**이 한 차트에서 비교되어야 한다.
    
- 백테스트에서 리밸런싱 주기/비용/배당재투자 옵션 변경에 따라 결과가 재계산되어야 한다.
    

---

원하면 다음까지 바로 이어서 만들어줄게요(질문 없이도 진행 가능):

1. **DB/도메인 모델(ERD 수준)**: Instrument, Position, Transaction, FXRate, PriceHistory, PortfolioRule 등
    
2. **API 명세(REST/GraphQL)**: /portfolios, /valuation/realtime, /backtest/run, /benchmarks 등
    
3. **정확한 계산 스펙**: TWR/MWR 수식, 현금흐름 처리, 환율 적용 시점(체결/평가) 정책
    
4. **모바일 UI 와이어프레임 수준의 화면 흐름** (온보딩부터 비교/백테스트까지)